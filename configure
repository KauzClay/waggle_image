#!/bin/bash
set -e

./install_dependencies.sh

export current_dir="$(pwd)"


if [ ! -e ${current_dir}/heartbeat.sh ] ; then
  print "heartbeat.sh not found"
  exit 1
fi

set -x
#mkdir -p /etc/supervisor/conf.d/
mkdir -p /var/log/waggle/

#ln -sf ${current_dir}/supervisor/heartbeat.conf /etc/supervisor/conf.d/heartbeat.conf
rm -f /etc/supervisor/conf.d/heartbeat.conf

cp ${current_dir}/upstart/waggle_heartbeat.conf /etc/init/

ln -sf ${current_dir}/scripts/waggle-service.py /usr/bin/waggle-service

ln -sf ${current_dir}/device_rules/atmel_boards/75-waggle-arduino.rules /etc/udev/rules.d/

set +x
echo "done"


